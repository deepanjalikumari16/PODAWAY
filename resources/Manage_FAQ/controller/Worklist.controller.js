sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,o,r){"use strict";return e.extend("com.coil.podway.Manage_FAQ.controller.Worklist",{formatter:i,onInit:function(){var e,i,o=this.byId("table");i=o.getBusyIndicatorDelay();this._aTableSearchState=[];e=new t({worklistTableTitle:this.getResourceBundle().getText("worklistTableTitle"),saveAsTileTitle:this.getResourceBundle().getText("saveAsTileTitle",this.getResourceBundle().getText("worklistViewTitle")),shareOnJamTitle:this.getResourceBundle().getText("worklistTitle"),shareSendEmailSubject:this.getResourceBundle().getText("shareSendEmailWorklistSubject"),shareSendEmailMessage:this.getResourceBundle().getText("shareSendEmailWorklistMessage",[location.href]),tableNoDataText:this.getResourceBundle().getText("tableNoDataText"),tableBusyDelay:0});this.setModel(e,"worklistView");o.attachEventOnce("updateFinished",function(){e.setProperty("/tableBusyDelay",i)});this.addHistoryEntry({title:this.getResourceBundle().getText("worklistViewTitle"),icon:"sap-icon://table-view",intent:"#ManageFAQ-display"},true)},onUpdateFinished:function(e){var t,i,o=this,r=this.getModel("worklistView").getProperty("/FaqCategoryId"),s=this.getModel("worklistView").getProperty("/NavigationId");if(r&&s){i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("IsArchived",sap.ui.model.FilterOperator.EQ,false),new sap.ui.model.Filter("FaqCategoryId",sap.ui.model.FilterOperator.EQ,r),new sap.ui.model.Filter("NavigationId",sap.ui.model.FilterOperator.EQ,s)],and:true})}else if(r&&!s){i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("IsArchived",sap.ui.model.FilterOperator.EQ,false),new sap.ui.model.Filter("FaqCategoryId",sap.ui.model.FilterOperator.EQ,r)],and:true})}else if(!r&&s){i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("IsArchived",sap.ui.model.FilterOperator.EQ,false),new sap.ui.model.Filter("NavigationId",sap.ui.model.FilterOperator.EQ,s)],and:true})}else if(!r&&!s){i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("IsArchived",sap.ui.model.FilterOperator.EQ,false)],and:true})}this.getModel().read("/FaqSet/$count",{filters:[i],async:true,success:function(e){t=o.getResourceBundle().getText("worklistTableTitleCount",[e]);o.getModel("worklistView").setProperty("/worklistTableTitle",t)}})},onPress:function(e){this._showObject(e.getSource())},onShareInJamPress:function(){var e=this.getModel("worklistView"),t=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:location.href,share:e.getProperty("/shareOnJamTitle")}}});t.open()},onAdd:function(e){this.getRouter().navTo("createObject")},onRefreshView:function(){var e=this.getModel();e.refresh(true)},onDelete:function(e){var t=e.getSource().getBindingContext().getPath();function i(){var e=this.getModel().getData(t);this.getModel().update(t,{NavigationId:e.NavigationId,FaqCategoryId:e.FaqCategoryId,Question:e.Question,Answer:e.Answer,IsArchived:true},{success:this.showToast.bind(this,"MSG_SUCCESS_FAQ_REMOVE")})}this.showWarning("MSG_CONFIRM_DELETE",i)},onEdit:function(e){this._showObject(e.getSource())},onSearch:function(){var e=this.getFiltersfromFB(),t=this.getView().byId("table");t.getBinding("items").filter(e);if(e.length!==0){if(e[0].sPath==="FaqCategoryId"){this.getModel("worklistView").setProperty("/FaqCategoryId",e[0].oValue1)}else{this.getModel("worklistView").setProperty("/FaqCategoryId",null)}if(e.length===1){if(e[0].sPath==="NavigationId"){this.getModel("worklistView").setProperty("/NavigationId",e[0].oValue1)}else{this.getModel("worklistView").setProperty("/NavigationId",null)}}if(e.length===2){if(e[1].sPath==="NavigationId"){this.getModel("worklistView").setProperty("/NavigationId",e[1].oValue1)}else{this.getModel("worklistView").setProperty("/NavigationId",null)}}this.getModel("worklistView").setProperty("/tableNoDataText",this.getResourceBundle().getText("worklistNoDataWithSearchText"))}else{this.getModel("worklistView").setProperty("/FaqCategoryId",null);this.getModel("worklistView").setProperty("/NavigationId",null)}},onRefresh:function(){var e=this.byId("table");e.getBinding("items").refresh()},_showObject:function(e){this.getRouter().navTo("object",{objectId:e.getBindingContext().getProperty("Id")})},getFiltersfromFB:function(){var e=this.getView().byId("filterbar"),t=[];e.getAllFilterItems().forEach(function(e){if(e.getControl().getSelectedKey()){t.push(new o(e.getName(),r.EQ,e.getControl().getSelectedKey()))}});return t},_applySearch:function(e){var t=this.byId("table"),i=this.getModel("worklistView");t.getBinding("items").filter(e,"Application");if(e.length!==0){i.setProperty("/tableNoDataText",this.getResourceBundle().getText("worklistNoDataWithSearchText"))}}})});