sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter"],function(e,t,i){"use strict";return e.extend("com.coil.podway.Dashboard.controller.Object",{formatter:i,onInit:function(){this.data={Category:{EntitySet:"/MasterRelationshipSet",fields:[{label:"Category",type:"Input",value:""},{label:"Building",type:"Select",binding:"/MasterServiceTypeSet",key:"Id",value:"ServiceType"}]}};var e=new sap.ui.model.json.JSONModel(this.data);this.getView().setModel(e,"json")},testFactory:function(e,t){var i=new sap.m.VBox({items:[new sap.m.Label({text:e.getProperty("label")})]});switch(e.getProperty("type")){case"Input":i.addItem(new sap.m.Input({value:{path:"json>/ "}}));break}},onShareInJamPress:function(){var e=this.getModel("objectView"),t=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:location.href,share:e.getProperty("/shareOnJamTitle")}}});t.open()},_onObjectMatched:function(e){var t=e.getParameter("arguments").objectId;this.getModel().metadataLoaded().then(function(){var e=this.getModel().createKey("BuildingSet",{Id:t});this._bindView("/"+e)}.bind(this))},_bindView:function(e){var t=this.getModel("objectView"),i=this.getModel();this.getView().bindElement({path:e,events:{change:this._onBindingChange.bind(this),dataRequested:function(){i.metadataLoaded().then(function(){t.setProperty("/busy",true)})},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=this.getModel("objectView"),i=e.getElementBinding();if(!i.getBoundContext()){this.getRouter().getTargets().display("objectNotFound");return}var n=this.getResourceBundle(),a=e.getBindingContext().getObject(),o=a.Id,s=a.BuildingName;t.setProperty("/busy",false);this.addHistoryEntry({title:this.getResourceBundle().getText("objectTitle")+" - "+s,icon:"sap-icon://enter-more",intent:"#Dashboard-display&/BuildingSet/"+o});t.setProperty("/saveAsTileTitle",n.getText("saveAsTileTitle",[s]));t.setProperty("/shareOnJamTitle",s);t.setProperty("/shareSendEmailSubject",n.getText("shareSendEmailObjectSubject",[o]));t.setProperty("/shareSendEmailMessage",n.getText("shareSendEmailObjectMessage",[s,o,location.href]))}})});