sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,n,s){"use strict";return e.extend("com.coil.podway.ManageVisitor.controller.Object",{formatter:i,onInit:function(){var e,i=new t({busy:true,delay:0});this.getRouter().getRoute("object").attachPatternMatched(this._onObjectMatched,this);e=this.getView().getBusyIndicatorDelay();this.setModel(i,"objectView");this.getOwnerComponent().getModel().metadataLoaded().then(function(){i.setProperty("/delay",e)})},onAfterRendering:function(){},onEmail:function(e){sap.m.URLHelper.triggerEmail(e.getSource().getText())},onTel:function(e){sap.m.URLHelper.triggerTel(e.getSource().getText())},onCall:function(){var e=this.getView().getBindingContext();if(e.getProperty("DialCode")&&e.getProperty("Mobile"))sap.m.URLHelper.triggerTel(e.getProperty("DialCode").concat(e.getProperty("Mobile")));else sap.m.MessageToast.show(this.getResourceBundle().getText("ERR_Mobile_no"))},onSMS:function(){var e=this.getView().getBindingContext();if(e.getProperty("DialCode")&&e.getProperty("Mobile"))sap.m.URLHelper.triggerSms(e.getProperty("DialCode").concat(e.getProperty("Mobile")));else sap.m.MessageToast.show(this.getResourceBundle().getText("ERR_Mobile_no"))},onShareInJamPress:function(){var e=this.getModel("objectView"),t=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:location.href,share:e.getProperty("/shareOnJamTitle")}}});t.open()},_onObjectMatched:function(e){var t=e.getParameter("arguments").objectId;this.getModel().metadataLoaded().then(function(){var e=this.getModel().createKey("UserSet",{Id:t});this._bindView("/"+e,t)}.bind(this))},_bindView:function(e,t){var i=this.getModel("objectView"),o=this.getModel();this.getView().bindElement({path:e,parameters:{filters:[new n("IsArchived",s.EQ,false),new n("RoleId",s.EQ,"3")],expand:"UserPreference/UserAccessibilityList/AccessiblityItem"},events:{dataRequested:function(){o.metadataLoaded().then(function(){i.setProperty("/busy",true)})},dataReceived:function(){i.setProperty("/busy",false)}}});this._bindTabs(t)},AccessibiltyItems:function(e,t){if(!e||!e.length){return""}var i=this.getModel();return e.filter(function(e){return i.getProperty("/"+e+"/"+"AccessiblityItem/AccessibilityId")===+t}).map(function(e){return i.getProperty("/"+e+"/AccessiblityItem/Title")}).join(",")},_bindTabs:function(e){var t=this.getView().byId("newReqs"),i=this.getView().byId("OngReqs"),n=this.getView().byId("CompReqs"),s=this.getView().byId("CanclReqs");this._bindTables(t,+e,1);this._bindTables(i,+e,2);this._bindTables(n,+e,3);this._bindTables(s,+e,4)},_bindTables:function(e,t,i){e.bindItems({path:"/AssignmentSet",filters:[new n("PODVisitorId",s.EQ,t),new n("AssignmentStatusId",s.EQ,i),new n("IsArchived",s.EQ,false)],parameters:{expand:"ServiceType,ServiceType/IncidentType"},template:this._getColumnListTemplae()})},_getColumnListTemplae:function(){var e=new sap.m.ColumnListItem;e.addCell(new sap.m.Text({text:"{ServiceType/ServiceType}"}));e.addCell(new sap.m.Text({text:"{ServiceType/IncidentType/IncidentType}"}));e.addCell(new sap.m.Text({text:"{ServiceType/IncidentType/ServiceMessage}"}));e.addCell(new sap.m.Text({text:"{Comments}"}));e.addCell(new sap.m.Button({type:"Transparent",icon:"sap-icon://locate-me",press:this.onNavigate.bind(this)}));return e}})});